---
title: 'Myeongshin Vehicle Sharing App Overview'
publishedAt: '2024-04-15'
summary: 'Exploring how a Flutter, Firebase, and REST-powered app helps employees reserve shared vehicles with confidence.'
category: 'Open Source'
githubURL: 'https://github.com/username/flutter-car-reservation'
image: '/medias/mdx-content/flutter-car-reservation.webp'
---

# Myeongshin Vehicle Sharing App

The Myeongshin vehicle sharing app is a Flutter project designed to allow company employees to reserve and manage corporate vehicles via smartphone. This article explores how state management via Provider, integration with Firebase Cloud Messaging, and the network layer including automatic token refresh work together.

## Why this project / motivation

Company vehicles are difficult to track for reservations and usage when demand is concentrated. We wanted to provide a mobile experience where employees can transparently check vehicle inventory, points, insurance terms, and receive notifications. We chose Flutter because it allows rapid deployment to iOS, Android, and web from a single codebase.

## What it does / overview

When the app runs, <InlineCode>MultiProvider</InlineCode> provides global core states such as user information, available points, and reservation dates, and all routes operate under <InlineCode>MaterialApp</InlineCode> set to Korean locale. Once Firebase initialization and permission requests are complete, users can handle the entire process within the app: login, vehicle search, reservation, reservation history check, point inquiry, terms confirmation, and inquiry submission.

<Callout icon='ğŸ’¡'>
  By sharing the navigation key when push notifications from Firebase Messaging
  are received, you can always return to the main flow.
</Callout>

## How it works (architecture, APIs, or hooks)

The architecture is divided into three axes.

1. **App bootstrap** â€“ Initialize Firebase in <InlineCode>main.dart</InlineCode>, request push, location, and camera permissions, then run <InlineCode>MyApp</InlineCode> wrapped in Provider.
2. **Service layer** â€“ <InlineCode>Agent</InlineCode> in <InlineCode>utils/agent.dart</InlineCode> handles all HTTP calls and automatically refreshes tokens when they expire.
3. **UI flow** â€“ The reservation screen composes date changes, insurance guidance, terms agreement, and payment button on one page, then moves to the congratulations screen and reservation history page on success.

Firebase Cloud Messaging notification handling abstracts <InlineCode>NotificationService</InlineCode> to respond differently when the app is in foreground, background, or terminated states. It manages Android channel initialization, local notification display, and background handler registration in one place.

## Code snippets (use <InlineCode> for small code and fenced tsx or ts for examples</InlineCode>)

The app entry point consists of Firebase initialization, permission requests, and Provider registration.

```dart
// lib/main.dart
runApp(
  MultiProvider(
    providers: [
      ChangeNotifierProvider(create: (_) => PointsProvider()),
      ChangeNotifierProvider(create: (_) => UserProvider()),
      ChangeNotifierProvider(create: (_) => DateProvider()),
    ],
    child: const MyApp(),
  ),
);
```

Shared navigator key, route map, and Korean locale settings are defined within <InlineCode>MyApp</InlineCode>.

```dart
// lib/app.dart
return MaterialApp(
  title: 'ëª…ì‹  ì°¨ëŸ‰ ê³µìœ ',
  initialRoute: Routes.mainScreen,
  navigatorKey: navigatorKey,
  debugShowCheckedModeBanner: false,
  theme: ThemeData(scaffoldBackgroundColor: COLORS.white),
  routes: {
    Routes.mainScreen: (context) => const AuthenticationFlowScreen(),
    Routes.signUp: (context) => const SignUpScreen(),
    Routes.signIn: (context) => const SignIn(),
    Routes.forgotPassword: (context) => const SendCodeScreen(),
    Routes.resetPwd: (context) => const ResetPasswordScreen(...),
  },
  supportedLocales: const [Locale('ko', 'KR')],
  locale: const Locale('ko', 'KR'),
);
```

HTTP í´ë¼ì´ì–¸íŠ¸ëŠ” í† í° ë§Œë£Œë¥¼ ê°ì§€í•´ ìë™ìœ¼ë¡œ ê°±ì‹ í•˜ê³ , 401/403 ì‘ë‹µ ì‹œ ë³´ì•ˆ ì €ì¥ì†Œë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.

```dart
// lib/utils/agent.dart
Future<http.Response> get(String endpoint) async {
  await checkAndRefreshToken();
  final url = Uri.parse('$_baseUrl$endpoint');
  final response = await http.get(url, headers: await _headers());
  _handleResponse(response);
  return response;
}

void _handleResponse(http.Response response) {
  if (response.body.isEmpty) return;
  if (response.statusCode < 200 || response.statusCode >= 300) {
    if (response.statusCode == 401 || response.statusCode == 403) {
      clearAllTokens();
    }
    final resBody = jsonFormatter(response);
    if (response.statusCode >= 500) {
      throw 'ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    }
    throw (resBody['message'] ?? resBody['error'] ?? response.reasonPhrase);
  }
}
```

ì˜ˆì•½ í™”ë©´ì€ ì‚¬ìš©ìê°€ ë‚ ì§œë¥¼ ì¡°ì •í•˜ê³ , ì•½ê´€ì„ ëª¨ë‘ ì²´í¬í•œ ë’¤ ê²°ì œë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤. ì„±ê³µí•˜ë©´ í¬ì¸íŠ¸ë¥¼ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê³ , ì˜ˆì•½ ë‚´ì—­ìœ¼ë¡œ ì´ë™í•˜ì£ .

```dart
// lib/screens/reservation/reserve_car/index.dart
void handleOnReserve() async {
  if (!allChecked) {
    return fireAlert(context, 'ì´ìš© ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.', () {});
  }
  if (_startDate.isAfter(_endDate) || _startDate.isBefore(DateTime.now())) {
    return fireToast(context, 'ì˜ˆì•½ ì‹œê°„ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤', isError: true);
  }

  setState(() => isLoading = true);
  try {
    await CarService().reserveCar({
      'carId': widget.car['id'],
      'rentalStartDate': _startDate.toIso8601String(),
      'rentalEndDate': _endDate.toIso8601String(),
      'rentalLocationId': widget.car['rentalLocationId'],
      'returnLocationId': widget.car['rentalLocationId'],
      'isBusiness': widget.isBusiness,
    });
    if (!mounted) return;
    Navigator.push(context, MaterialPageRoute(builder: (_) => Success(...)));
    await Provider.of<PointsProvider>(context, listen: false).fetchTotalPoints();
  } catch (e) {
    if (!mounted) return;
    fireAlert(context, e.toString(), () {});
  } finally {
    setState(() {
      isLoading = false;
      allChecked = false;
    });
  }
}
```

## Demo / Media if applicable (use `<RoundedVideo>` or `<Image>` components)

<RoundedVideo
  src='/medias/mdx-content/flutter-car-reservation-demo.mp4'
  title='ì°¨ëŸ‰ ì˜ˆì•½ íë¦„ ì‹œì—°'
/>

## Conclusion (reflective summary of developer benefits or learnings)

ì´ í”„ë¡œì íŠ¸ëŠ” Flutterì˜ ì„ ì–¸í˜• UIì™€ Provider ìƒíƒœ ê´€ë¦¬, ê·¸ë¦¬ê³  Firebase Cloud MessagingÂ·ë³´ì•ˆ í† í° ì¬ë°œê¸‰ ë¡œì§ì„ ê²°í•©í•´ ì‹¤ì œ ì—…ë¬´ì—ì„œ ì“°ì¼ ìˆ˜ ìˆëŠ” ì°¨ëŸ‰ ê³µìœ  ê²½í—˜ì„ ì™„ì„±í•©ë‹ˆë‹¤. ëª…í™•í•œ ì„œë¹„ìŠ¤ ê³„ì¸µê³¼ ì‹ ë¢°ë„ ë†’ì€ ì•Œë¦¼ ì‹œìŠ¤í…œ ë•ë¶„ì— ê°œë°œìëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ë¹ ë¥´ê²Œ ì¶”ê°€í•˜ê³ , ì‚¬ìš©ìëŠ” ì˜ˆì•½ ìƒíƒœë¥¼ ë†“ì¹˜ì§€ ì•Šì„ ìˆ˜ ìˆì£ . ì „ì²´ ì†ŒìŠ¤ëŠ” GitHubì—ì„œ ì§ì ‘ í™•ì¸í•˜ê³  ì—¬ëŸ¬ë¶„ì˜ ì¡°ì§ í™˜ê²½ì— ë§ê²Œ í™•ì¥í•´ ë³´ì„¸ìš”.
